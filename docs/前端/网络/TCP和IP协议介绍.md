###  TCP/IP 介绍

计算机与网络设备要相互通信，双方就必须基于相同的方法。比如，如何探测到通信目标、由哪一边先发起通信、使用哪种语言进行通信、怎样结束通信等规则都需要事先确定。不同的硬件、操作系统之间的通信，所有的这一切都需要一种规则。而我们就把这种规则称为协议（protocol）。TCP/IP 是互联网相关的各类协议族的总称

![image-20231023095431416](http://image.wangxiaohuan.com/blog/image/202310230954388.png)

### TCP/IP 的分层管理

TCP/IP 协议族按层次分别分为以下 4 层：应用层、传输层、网络层和数据链路层：

应用层：应用层决定了向用户提供应用服务时通信的活动。

传输层：传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输。

网络层：网络层用来处理在网络上流动的数据包。

链路层：用来处理连接网络的硬件部分。

#### 分层的好处

层次化之后，设计也变得相对简单了。处于应用层上的应用可以只考虑分派给自己的任务，而不需要弄清对方在地球上哪个地方、对方的传输路线是怎样的、是否能确保传输送达等问题。

### TCP/IP 通信传输流

![image-20231023100755300](http://image.wangxiaohuan.com/blog/image/202310231007152.png)

![image-20231023100831511](http://image.wangxiaohuan.com/blog/image/202310231008445.png)

发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接收端在层与层传输数据时，每经过一层时会把对应的首部消去。这种把数据信息包装起来的做法称为封装（encapsulate）。



### 数据包

**包、帧、数据包、段、消息**

以上五个术语都用来表述数据的单位，大致区分如下：

- 包可以说是全能性术语；
- 帧用于表示数据链路层中包的单位；
- 数据包是 IP 和 UDP 等网络层以上的分层中包的单位；
- 段则表示 TCP 数据流中的信息；
- 消息是指应用协议中数据的单位。

每个分层中，都会对所发送的数据附加一个首部，在这个首部中包含了该层必要的信息，如发送的目标地址以及协议相关信息。通常，为协议提供的信息为包首部，所要发送的内容为数据。在下一层的角度看，从上一层收到的包全部都被认为是本层的数据。

![](http://image.wangxiaohuan.com/blog/image/202310231002356.jpeg)

数据包首部

网络中传输的数据包由两部分组成：一部分是协议所要用到的首部，另一部分是上一层传过来的数据。首部的结构由协议的具体规范详细定义。在数据包的首部，明确标明了协议应该如何读取数据。反过来说，看到首部，也就能够了解该协议必要的信息以及所要处理的数据。**包首部就像协议的脸。**